<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:replace="~{fragments/layout :: head-content}"></th:block>
    <title>Policy Holders - Insurance Manager</title>
</head>

<body class="bg-[#0a0a0a] text-white flex flex-col min-h-screen pt-20">

    <div th:replace="~{fragments/layout :: navbar}"></div>

    <main class="flex-grow container mx-auto px-4 py-12">
        <div class="max-w-6xl mx-auto space-y-8">

            <!-- Header & Search -->
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                <div>
                    <h1 class="text-3xl md:text-5xl font-bold tracking-tight">
                        Policy <span class="text-[#ff6b00]">Holders</span>
                    </h1>
                    <p class="text-gray-400 mt-2">Manage and view customer policies.</p>
                </div>

                <!-- Search Form -->
                <form action="/policies" method="get" class="w-full md:w-auto relative group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-gray-500 group-focus-within:text-[#ff6b00] transition-colors"></i>
                    </div>
                    <input type="text" name="search" th:value="${search}"
                        class="bg-white/5 border border-white/10 text-white text-sm rounded-lg focus:ring-[#ff6b00] focus:border-[#ff6b00] block w-full pl-10 p-3 w-full md:w-80 backdrop-blur-sm transition-all shadow-[0_0_15px_rgba(0,0,0,0.3)] focus:shadow-[0_0_20px_rgba(255,107,0,0.2)]"
                        placeholder="Search by holder name...">
                    <button type="submit"
                        class="absolute inset-y-0 right-0 px-4 text-sm font-medium text-white bg-[#ff6b00] rounded-r-lg hover:bg-[#e65100] focus:ring-4 focus:outline-none focus:ring-[#ff6b00]/30 transition-all">
                        Search
                    </button>
                </form>
            </div>

            <!-- Policies Table -->
            <div
                class="overflow-hidden rounded-2xl border border-[#ff6b00] shadow-[0_0_20px_rgba(255,107,0,0.15)] bg-white/5 backdrop-blur-md">
                <table class="w-full text-left text-gray-300">
                    <thead
                        class="bg-black/40 text-xs uppercase text-[#ff6b00] font-bold tracking-wider border-b border-[#ff6b00]/30">
                        <tr>
                            <th scope="col" class="px-6 py-5">Policy Holder Name</th>
                            <th scope="col" class="px-6 py-5">Active Policies</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-white/10">
                        <tr th:each="user : ${users}" class="hover:bg-white/5 transition-colors group">
                            <!-- User Name -->
                            <td class="px-6 py-6 whitespace-nowrap">
                                <div class="flex items-center gap-4">
                                    <div
                                        class="h-10 w-10 rounded-full bg-gradient-to-br from-[#ff6b00] to-[#9a3412] flex items-center justify-center text-white font-bold shadow-lg">
                                        <span th:text="${#strings.substring(user.name,0,1)}">A</span>
                                    </div>
                                    <div>
                                        <div class="text-lg font-bold text-white group-hover:text-[#ff6b00] transition-colors"
                                            th:text="${user.name}">John Doe</div>
                                        <div class="text-xs text-gray-500" th:text="${user.email}">john@example.com
                                        </div>
                                    </div>
                                </div>
                            </td>

                            <!-- Policies List -->
                            <td class="px-6 py-6">
                                <div class="flex flex-wrap gap-2" th:if="${not #lists.isEmpty(user.documents)}">
                                    <span th:each="doc : ${user.documents}"
                                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#ff6b00]/10 text-[#ff6b00] border border-[#ff6b00]/20 shadow-[0_0_10px_rgba(255,107,0,0.1)] hover:shadow-[0_0_15px_rgba(255,107,0,0.2)] hover:bg-[#ff6b00]/20 transition-all cursor-default">
                                        <i class="fas fa-file-contract mr-1.5"></i>
                                        <span th:text="${doc.title}">Start Policy</span>
                                    </span>
                                </div>
                                <div th:if="${#lists.isEmpty(user.documents)}" class="text-sm text-gray-600 italic">
                                    No policies found
                                </div>
                            </td>
                        </tr>

                        <!-- Empty State -->
                        <tr th:if="${#lists.isEmpty(users)}">
                            <td colspan="2" class="px-6 py-12 text-center text-gray-500">
                                <div class="flex flex-col items-center gap-3">
                                    <i class="fas fa-search text-4xl opacity-20"></i>
                                    <p>No policy holders found matching your search.</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>
    </main>

    <div th:replace="~{fragments/layout :: footer}"></div>

</body>

</html>